---
title: "**Case Study 2: Paris 2024 Team USA Olympics Gymnastics Team**"
author: "Aimi Wen, Katie Nash, Nidhi Dhupati, Wendy Shi"
geometry: "left=1cm,right=1cm,top=1.5cm,bottom=1.5cm"
output: 
  pdf_document:
    fig_caption: yes
warnings: false
fontsize: 9
includes:  
      in_header: in_text.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, include = FALSE}
# load in libraries
package_list <- c("tidyverse", "vroom", "stringr", "dplyr", "ggsci", "gridExtra")

# load in packages
for (package_name in package_list) {
  if (!requireNamespace(package_name, quietly = TRUE)) {
    install.packages(package_name)
  }
  library(package_name, character.only = TRUE)
}

# load in data
df <- vroom("cleandata/data_2022_2023.csv")


```

```{r, include = FALSE}
# Clean up names to make sure there is unique name for each athlete.
# taking the first part of the names to simplify
df <- df%>%
  mutate(first_name_only = word(FirstName, 1)) %>%
  mutate(last_name_only = word(LastName, 1))

# standardizing countries. Ex know Scotland and Wales all compete with England as Great Britain.
df_c <- df %>%
  mutate(
    clean_country = case_when(Country == "SCO" ~ "GBR", 
                              Country == "ENG" ~ "GBR", 
                              Country == "WAL" ~ "GBR",
                              Country == "SIN" ~ "SIG", 
                              Country == "GE1" ~ "GER", 
                              Country == "GE2" ~ "GER", 
                              Country == "NIR" ~ "GBR",
                              Country == "IOM" ~ "GBR", 
                              Country == "PUR" ~ "USA",
                              TRUE ~ Country
      
    )
  )

# Simplifying accents in names and dashes
replace_letters <- function(name){
  name <- gsub("Ö", "OE", name)
  name <- gsub("Ü", "U", name)
  name <- gsub("Ø", "O", name)
  name <- sub("-.*", "", name)
  name <- gsub("Ä", "AE", name)
  return(name)
}

standardize <- function(name){
  name <- iconv(name, "UTF-8", "ASCII//TRANSLIT")
  return (name)
}

# Applying accent cleaning function to dataframe's name columns.
df_c$first_name_only <- lapply(df_c$first_name_only, replace_letters)
df_c$last_name_only <- lapply(df_c$last_name_only, replace_letters)

df_c$first_name_only <- lapply(df_c$first_name_only, standardize)
df_c$last_name_only <- lapply(df_c$last_name_only, standardize) 


# mutate to create name variable comprising of both first and last name
df_c <- df_c %>%
  mutate(name = paste(first_name_only, last_name_only))

# Separating into two dataset of men and women's gymnastics
df_men_c <- df_c%>%
  filter(Gender == "m")

df_women_c <- df_c%>%
  filter(Gender == "w")

  
```

```{r, include = FALSE}
# Manual cleaning done on name for women's data
df_women_c <- df_women_c %>%
  mutate(
    clean_name = case_when(
      name == "Anna KONIG" ~ "Anna KOENIG",
      name == "Aberdeen O" ~ "Aberdeen O'DRISCOL", 
      name == "Christina KIOSO" ~ "Christina VASILOPOULOU",
      name == "Korkem YEROBSSYNKYZY" ~ "Korkem YERBOSSYNKYZY",
      name == "Larasati REGGANIS" ~ "Larasati RENGGANIS", 
      name == "Liu MAI" ~ "Mai LIU" ,
      name == "Melanie DE" ~ "Melanie DE JESUS", 
      name == "Melanie JESUS" ~ "Melanie DE JESUS", 
      name == "Milka ELPITIYA" ~ "Milka GEHANI", 
      name == "NA ELPITIYA" ~ "Milka GEHANI", 
      name == "Nika KUKULJAN" ~ "Nika FRLETA", 
      name == "Olivia MAFES" ~ "Olivia Kelly", 
      name == "Ruby EVAN" ~ "Ruby EVANS", 
      name == "Sasiwimion MUEANGPHUAN" ~ "Sasiwimon MUEANGPHUAN", 
      name == "Shade OORSCHOT" ~ "Shade VAN OORSCHOT",
      name == "Shade VAN" ~ "Shade VAN OORSCHOT", 
      name == "Vera VAN" ~ "Vera VAN POL", 
      name == "Vera POL"  ~ "Vera VAN POL", 
      name == "Wong VANESSA" ~ "Vanessa WONG", 
      name == "Zeina SHARAF" ~ "Zeina IBRAHIM", 
      name == "NA JESUS" ~ "Melanie DE JESUS",
      TRUE ~ name
    )
  )

# Manual cleaning done on country specifications for women's data
df_women_c <- df_women_c %>%
  mutate(
    clean_country = ifelse(clean_name == "Teja BELAK", "SLO", clean_country), 
    clean_country = ifelse(clean_name == "Naveen DARIES", "RSA", clean_country), 
    clean_country = ifelse(clean_name == "Madeleine MARSHALL", "NZL", clean_country)
  )

df_women_c <- df_women_c %>%
  filter(!is.na(first_name_only))

numeric_columns <- sapply(df_women_c, is.numeric)
df_women_c[numeric_columns][is.na(df_women_c[numeric_columns])] <- 0
```

```{r , include = FALSE}
# Manual cleaning done on name for men's data
df_men_c <- df_men_c %>%
  mutate(
    clean_name = case_when(
      name == "Mc ATEER" ~ "Ewan MCATEER",
      name == "Ewan MC" ~ "Ewan MCATEER", 
      name == "Mc CLENAGHAN" ~ "Rhys MCCLENAGHAN",
      name == "Rhys MC" ~ "Rhys MCCLENAGHAN",
      name == "Samual DICK" ~ "Samuel DICK",
      name == "William FU" ~ "William FUALLEN",
      name == "Jermain GRUNBERG" ~ "Jermain GRUENBERG", 
      name == "Rakah HARITHI" ~ "Rakan HARITHI",
      name == "Vinzenz HOCK" ~ "Vinzenz HOECK",
      name == "VInzenz HOECK" ~ "Vinzenz HOECK",
      name == "Mohamad KHALIL" ~ "Mohamed KHALIL",
      name == "Severin KRANZLMULLER" ~ "Severin KRANZLMUELLER",
      name == "NA KUMARASINGHEGE" ~ "Hansha KUMARASINGHEGE",
      name == "Manuel MARTINEZ" ~ "Jose MARTINEZ",
      name == "Felipe MARTINEZ" ~ "Andres MARTINEZ",
      name == "Clay MASON" ~ "Clay MASONSTEPHENS",
      name == "Dimitrijs MICKEVICS" ~ "Dmitrijs MICKEVICS",
      name == "Dmitry PATANIN" ~ "Dmitriy PATANIN",
      name == "NA SOUZA" ~ "Caio SOUZA",
      name == "Jann TIMBANG" ~ "Jan TIMBANG",
      name == "Kim VANSTROM" ~ "Kim VANSTROEM",
      name == "Sam ZAKUTNEY" ~ "Samuel ZAKUTNEY",
      name == "Fred RICHARD" ~ "Frederick RICHARD",
      TRUE ~ name
    )
  )

# Manual cleaning done on country specifications for men's data
df_men_c <- df_men_c %>%
  mutate(
    clean_country = ifelse(clean_name == "Ewan MCATEER", "IRL", clean_country), 
    clean_country = ifelse(clean_name == "Rhys MCCLENAGHAN", "IRL", clean_country), 
    clean_country = ifelse(clean_name == "Dominick CUNNINGHAM", "IRL", clean_country),
    clean_country = ifelse(clean_name == "Eamon MONTGOMERY", "IRL", clean_country),
    clean_country = ifelse(clean_name == "NIkita SIMONOV", "AZE", clean_country)
  )

df_men_c <- df_men_c %>%
  filter(!is.na(first_name_only))

numeric_columns <- sapply(df_men_c, is.numeric)
df_men_c[numeric_columns][is.na(df_men_c[numeric_columns])] <- 0

```

```{r, include = FALSE}
df_men_names <- df_men_c %>%
  distinct(last_name_only, first_name_only, clean_country, name)

```

```{r ordering-competitions-women, include = FALSE}

unique(df_women_c$Competition)

df_women_c <- df_women_c %>%
  mutate(competition_number = case_when(
    Competition == "2022 Cottbus World Cup" ~ "1",
    Competition == "2022 Winter Cup" ~ "2",
    Competition == "2022 Doha World Cup" ~ "3",
    Competition == "2022 Cairo World Cup" ~ "4",
    Competition == "2022 British Gymnastics Championships" ~ "5",
    Competition == "2022 Varna World Challenge Cup" ~ "6",
    Competition == "2022 Baku World Cup" ~ "7",
    Competition == "2022 Osijek World Challenge Cup" ~ "8",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "9",
    Competition == "2022 Koper World Challenge Cup" ~ "10",
    Competition == "2022 U.S. Classic" ~ "11",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "12",
    Competition == "2022 Senior European Championships" ~ "13",
    Competition == "2022 U.S. Championships" ~ "14",
    Competition == "2022 Paris World Challenge Cup" ~ "15",
    Competition == "2022 Szombathely World Challenge Cup" ~ "16",
    Competition == "2022 Mersin World Challenge Cup" ~ "17",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "18",
    Competition == "2023 Cottbus World Cup" ~ "19",
    Competition == "2023 Winter Cup" ~ "20",
    Competition == "2023 Doha World Cup" ~ "21",
    Competition == "2023 Baku World Cup" ~ "22",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "23",
    Competition == "2023 British Gymnastics Championships" ~ "24",
    Competition == "2023 Senior European Championships" ~ "25",
    Competition == "2023 Cairo World Cup" ~ "26",
    Competition == "2023 Varna World Challenge Cup" ~ "27",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "28",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "29",
    Competition == "2023 Osijek World Challenge Cup" ~ "30",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "31",
    Competition == "2023 Central American and Caribbean Games" ~ "32",
    Competition == "2023 FISU World University Games" ~ "33",
    Competition == "2023 Core Hydration Classic" ~ "34",
    Competition == "2023 U.S. Championships" ~ "35",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "36",
    TRUE ~ "Other"
  ))

df_women_c = df_women_c %>%
  mutate(competition_number = as.numeric(competition_number))

```

```{r categorizing-competitions-women, include = FALSE}

df_women_c <- df_women_c %>%
  mutate(competition_scope = case_when(
    Competition == "2022 Cottbus World Cup" ~ "World",
    Competition == "2022 Winter Cup" ~ "USA",
    Competition == "2022 Doha World Cup" ~ "World",
    Competition == "2022 Cairo World Cup" ~ "World",
    Competition == "2022 British Gymnastics Championships" ~ "non-USA",
    Competition == "2022 Varna World Challenge Cup" ~ "World",
    Competition == "2022 Baku World Cup" ~ "World",
    Competition == "2022 Osijek World Challenge Cup" ~ "World",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2022 Koper World Challenge Cup" ~ "World",
    Competition == "2022 U.S. Classic" ~ "USA",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "non-USA",
    Competition == "2022 Senior European Championships" ~ "non-USA",
    Competition == "2022 U.S. Championships" ~ "USA",
    Competition == "2022 Paris World Challenge Cup" ~ "World",
    Competition == "2022 Szombathely World Challenge Cup" ~ "World",
    Competition == "2022 Mersin World Challenge Cup" ~ "World",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "World",
    Competition == "2023 Cottbus World Cup" ~ "World",
    Competition == "2023 Winter Cup" ~ "USA",
    Competition == "2023 Doha World Cup" ~ "World",
    Competition == "2023 Baku World Cup" ~ "World",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "World",
    Competition == "2023 British Gymnastics Championships" ~ "non-USA",
    Competition == "2023 Senior European Championships" ~ "non-USA",
    Competition == "2023 Cairo World Cup" ~ "World",
    Competition == "2023 Varna World Challenge Cup" ~ "World",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "USA",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "World",
    Competition == "2023 Osijek World Challenge Cup" ~ "World",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2023 Central American and Caribbean Games" ~ "non-USA",
    Competition == "2023 FISU World University Games" ~ "USA",
    Competition == "2023 Core Hydration Classic" ~ "USA",
    Competition == "2023 U.S. Championships" ~ "USA",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "World",
    TRUE ~ "Other"
  ))

```

```{r ordering-competitions-men, include = FALSE}

df_men_c <- df_men_c %>%
  mutate(competition_number = case_when(
    Competition == "2022 Cottbus World Cup" ~ "1",
    Competition == "2022 Winter Cup" ~ "2",
    Competition == "2022 Doha World Cup" ~ "3",
    Competition == "2022 Cairo World Cup" ~ "4",
    Competition == "2022 British Gymnastics Championships" ~ "5",
    Competition == "2022 Varna World Challenge Cup" ~ "6",
    Competition == "2022 Baku World Cup" ~ "7",
    Competition == "2022 Osijek World Challenge Cup" ~ "8",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "9",
    Competition == "2022 Koper World Challenge Cup" ~ "10",
    Competition == "2022 U.S. Classic" ~ "11",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "12",
    Competition == "2022 Senior European Championships" ~ "13",
    Competition == "2022 U.S. Championships" ~ "14",
    Competition == "2022 Paris World Challenge Cup" ~ "15",
    Competition == "2022 Szombathely World Challenge Cup" ~ "16",
    Competition == "2022 Mersin World Challenge Cup" ~ "17",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "18",
    Competition == "2023 Cottbus World Cup" ~ "19",
    Competition == "2023 Winter Cup" ~ "20",
    Competition == "2023 Doha World Cup" ~ "21",
    Competition == "2023 Baku World Cup" ~ "22",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "23",
    Competition == "2023 British Gymnastics Championships" ~ "24",
    Competition == "2023 Senior European Championships" ~ "25",
    Competition == "2023 Cairo World Cup" ~ "26",
    Competition == "Oceania Continental Championships 2023" ~ "27",
    Competition == "2023 Varna World Challenge Cup" ~ "28",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "29",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "30",
    Competition == "2023 Osijek World Challenge Cup" ~ "31",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "32",
    Competition == "2023 Central American and Caribbean Games" ~ "33",
    Competition == "2023 FISU World University Games" ~ "34",
    Competition == "2023 Core Hydration Classic" ~ "35",
    Competition == "2023 U.S. Championships" ~ "36",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "37",
    TRUE ~ "Other"
  ))

df_men_c = df_men_c %>%
  mutate(competition_number = as.numeric(competition_number))

```

```{r categorizing-competitions-men, include = FALSE}

df_men_c <- df_men_c %>%
  mutate(competition_scope = case_when(
    Competition == "2022 Cottbus World Cup" ~ "World",
    Competition == "2022 Winter Cup" ~ "USA",
    Competition == "2022 Doha World Cup" ~ "World",
    Competition == "2022 Cairo World Cup" ~ "World",
    Competition == "2022 British Gymnastics Championships" ~ "non-USA",
    Competition == "2022 Varna World Challenge Cup" ~ "World",
    Competition == "2022 Baku World Cup" ~ "World",
    Competition == "2022 Osijek World Challenge Cup" ~ "World",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2022 Koper World Challenge Cup" ~ "World",
    Competition == "2022 U.S. Classic" ~ "USA",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "non-USA",
    Competition == "2022 Senior European Championships" ~ "non-USA",
    Competition == "2022 U.S. Championships" ~ "USA",
    Competition == "2022 Paris World Challenge Cup" ~ "World",
    Competition == "2022 Szombathely World Challenge Cup" ~ "World",
    Competition == "2022 Mersin World Challenge Cup" ~ "World",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "World",
    Competition == "2023 Cottbus World Cup" ~ "World",
    Competition == "2023 Winter Cup" ~ "USA",
    Competition == "2023 Doha World Cup" ~ "World",
    Competition == "2023 Baku World Cup" ~ "World",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "World",
    Competition == "2023 British Gymnastics Championships" ~ "non-USA",
    Competition == "2023 Senior European Championships" ~ "non-USA",
    Competition == "2023 Cairo World Cup" ~ "World",
    Competition == "Oceania Continental Championships 2023" ~ "non-USA",
    Competition == "2023 Varna World Challenge Cup" ~ "World",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "USA",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "World",
    Competition == "2023 Osijek World Challenge Cup" ~ "World",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2023 Central American and Caribbean Games" ~ "non-USA",
    Competition == "2023 FISU World University Games" ~ "USA",
    Competition == "2023 Core Hydration Classic" ~ "USA",
    Competition == "2023 U.S. Championships" ~ "USA",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "World",
    TRUE ~ "Other"
  ))

```

## Introduction

### Background Information

The Olympic Games are an international multi-sport event held every four years, and are largely considered to be the most prestigious sporting competition in the world. These Games are therefore a popular spectator event across the world, with an average viewership of more than 15 million people in past years [1]. The 2024 Olympic Games will be held in Paris, France, and will include both Men's and Women's Artistic Gymnastics events. These Gymnastics events in particular are highly anticipated: as of March 2021, Artistic Gymnastics was the most followed Summer Olympics sport [2].

Winning a medal in an Olympic gymnastics event is an honor for both the individual athlete and for the country that athlete represents; the medal brings a sense of national pride to citizens across the country and promotes the global recognition of the winning country. Because of the high honor and importance of upholding the legacy of the United States in these competitions, it is important to carefully select the men and women who will represent our country as Team USA in the Artistic Gymnastics events. The importance of and interest surrounding the Olympics provides a rich foundation for statistical analysis of past athlete performances and an interesting platform for making predictions about who will best represent Team USA in future Olympics. There have already been analyses, published in major news outlets, about who Team USA will consist of for non-gymnastics sports in 2024 [3].

The objective of this project is to extend this analysis to the Artistic Gymnastics events, and to select the 5 athletes for each of the men's and women's events that will optimize performance for Team USA. The format of the Olympic Artistic Gymnastics event includes a qualifying round and final round. Scores from qualifying rounds do not impact medal determinations, but rather decide which athletes advance to the finals. The final round, which is what determines medal placements, consists of team all-around, individual all-around, and individual apparatus events. Men's opportunities for medals are: 1) team all-around, 2) individual all-around, 3) floor exercise, 4) pommel horse, 5) still rings, 6) vault, 7) parallel bars, and 8) high bar. Women's opportunities for medals are: 1) team all-around, 2) individual all-around, 3) vault, 4) uneven bars, 5) balance beam, and 6) floor exercise. The athletes representing Team USA will compete in a pool of 96 men and 96 women, which will include teams of five from other countries as well as the option for individual entries for countries without full team qualifications.

Our hypothesis is:

-   Who are the 5 men and 5 women who can make Team USA achieve the highest level of success at the Paris 2024 Artistic Gymnastics Event?

### Data Description

The dataset was provided by UConn Sports Analytics Symposium (UCSAS). Major worldwide and national Gymnastics competitions were included in two separate datasets: one for 2017-2021 competitions, and one for the 2022-2023 season leading up to the 2024 Paris Games. The competition data included scoring information, athlete names, athlete demographic information, athlete scores, and competition details. Each entry in the dataset is one event from one athlete, which includes the country affiliation of the athlete, the competition and competition location, the difficulty, execution, penalty, and overall scores, the apparatus that the athlete competed on, and their ranking. Additionally, the countries who qualified as a team, which are the countries that will be allowed to compete in the Team All-Around event for the men's and women's Olympic events, were provided. Verification of athlete names and country affiliation was conducted by using Wikipedia [3] alongside the USA Gymnastics website [4]. The dataset we used for analysis was last synced with the central UCSAS repository on November 2nd.

## Methodology

### Data Cleaning

Since our goal is to optimize performance in the 2024 Olympics, we chose to only include competition data from 2022 and 2023, while excluding data from the 2017-2021 season. This reflects the unprecedented global pandemic that caused even the Tokyo Olympics to be delayed, and the scoring differences before 2021 versus now, and a potential turnover in athletes. We assumed that competition data from the two most recent years would be the most useful in understanding 2024 Olympic performance. From the original 2022-2023 competition dataset, we standardized variables and added columns. We standardized each athlete's name based on the first instance it appeared and created a column that included the full name of the athlete. Additionally, we made sure the country codes were consistent with International Olympic Committee Codes (for example, Scotland competes as part of the United Kingdom in the Olympics). We also separated the competition data into two datasets of men's and women's competitions, created a variable to track the order in the competitions that occurred by their dates, and added a competition scope variable to aid with data visualizations and athlete selection in the analysis approach. For our Team All-Around analysis approach, which is written in more detail below, we also created a separate dataframe for analysis. After cleaning the data, we looked at Appendix 1 to show that each country has a wide range of performances across past competitions. This brought us to create an athlete selection criteria to narrow down our possible pool of athletes for our analysis approach, which is detailed below.

### Analysis Approach

In order to study which athletes could enable Team USA to achieve maximum success at the Paris Olympics, we decided to model possible Olympic scenarios by simulating the medal outcomes of different versions of Team USA (different combinations of 5 athletes)  competing with teams from other countries. One iteration of our simulation would model one run of the Olympics. We conducted a separate simulation process for the Men's Artistic Gymnastics Event and the Women's Artistic Gymnastics Event. Our metric of success was a weighted medal count: we assigned 3 points to a Gold medal, 2 points to a Silver medal, and 1 point to a Bronze medal. This reflects our belief in the relative prestige of each medal and will allow the highest score to reflect our interpretation of the highest level of success. The methodology can be broken down into the following subsections: athlete selection, creating score distributions, team selection, Team All-Around event simulation, individual event simulation, and finding the top-performing USA teams.

#### Athlete Selection Criteria

We only included a group of "elite athletes" as our potential athlete selection pool. To create this pool, we included athletes who placed in the top 10 at a World competition or in the top 3 at a non-world competition. This reflects two assumptions: 1) the Olympic competition would only consist of athletes who are already competing at the highest level, and 2) world competitions are more competitive than non-world competitions, so a larger placement range should be allowed.

#### Creating Score Distributions

The next step was to simulate the score that each athlete receives on each apparatus. We created a score distribution for each athlete and apparatus based on the observed scores they received in past competitions on this apparatus, while adding noise and allowing higher or lower scores than the range of scores they have received in the past. We used the process of kernel density estimation (KDE), which provides a continuous representation of the score distribution estimated from their past scores. Note that treated Vault 1 and Vault 2 as separate distributions, because there could be a meaningful difference between the score distributions, since gymnasts use the opportunity for two vaults to demonstrate different techniques and execution styles [15]. Mathematical details about the development of our KDE are included in the appendix.

Although we are only simulating scores for the final rounds, since those are the medal-earning events, we decided to include athlete scores from qualification and final rounds in our creation of the KDEs in order to have more data points to estimate from. Additionally, we only created the KDEs based on the total score for the athlete, instead of separating the scores by difficulty score, execution score, and penalty score. Since the total score is difficulty score + execution score - penalty score, it encompasses all of these sub-scores. Appendix Figure 2 additionally demonstrates that most penalty scores are near 0.

#### Team Selection

In order to simulate Olympics outcomes, we had to select a team of five gymnasts for each qualifying country in the Olympics, for each simulation round. For each qualifying country, we used weighted random sampling to select 5 gymnasts. Weighted random sampling was chosen rather than simple random sampling in order for the highest performing athletes to be sampled more often. This allows for the formation of teams to be more realistic, reflecting the assumption that each country would only select their top performers to represent their country in the Olympics. The weighting was based on the median of each athlete's kernel density for each apparatus, and reflects the observed past score and skill level of the athletes. Mathematical details about the weighting process are included in the appendix, and further explanation and justification is included as well.

#### Team All-Around Simulation

To simulate the team all-around competition, three gymnasts would need to be selected to compete for each apparatus, from the five gymnasts on each team. We simulated scores for all of the 5 athletes across all events by sampling scores from the appropriate kernel density, and chose the athletes who had the 3 highest simulated scores on each apparatus to represent their country for that apparatus in the Team All Around. We assumed this approximately mimics a coach's selection criteria in real life. Once every qualifying country had three athletes selected for each apparatus, the scores for the actual event with these athletes were again simulated from their kernel densities. Then, the scores for all apparatuses were summed by country to create the final scores for the Team All-Around event. The top 3 teams were given the appropriate medal counts.

#### Individual Events Simulation

Unlike the Team All-Around, individual events allow for athletes from countries that did not qualify as part of a team. Therefore, when simulating individual events, our dataset included five athletes who were selected (via the weighted random selection process) for each qualifying country, as well as all of the athletes who passed our athlete selection criteria but did not belong to a qualifying country. For each individual event and athlete, we assigned scores by randomly sampling using the appropriate athlete and apparatus KDE score density. For individual events where multiple scores can be recorded (the individual all-around and vault events), we summed each score together to represent the final score for each event. The top 3 athletes for each event were given the appropriate medal counts.

#### Finding the Top USA Teams

We ran 3000 simulations for the Men's Artistic Gymnastics Event, and a separate 3000 simulations for the Women's Artistic Gymnastics Event. Each simulation included a separate selection process for the five athletes who would represent each qualifying country. After running these simulations, we selected the top 10 simulations where the USA scored the highest weighted medal count for each gender. We extracted the athletes that represented Team USA in each of these top 10 simulations. Since the USA performed highly in each of these simulations, we decided to run another 300 simulations to narrow down from these top 10 teams. With the additional 300 simulations, we randomly selected the athletes in other qualifying countries but kept the same athletes in every simulation for the United States. These additional simulations address the potential variability in our simulated scores and the possibility that Team USA may have just scored highly in one of the "top 10" simulations due to poor performances of other countries. After running the 300 simulations for each of the top 10 teams (so 3000 simulations total) per gender, we tracked how many times the United States had the highest weighted medal count of all countries for each team. We chose the team that had the maximum weighted medal count of all countries for the highest percentage of times as our final suggested men's Team USA. For women's gymnastics, there ended up being multiple teams tied with the same highest percentage.

#### Breaking the Tie for Women

There were multiple teams who tied amongst the women, which are included in the results section. We took the teams that tied, found the athletes who were chosen the most frequently from these teams, and created the second iteration of "high-performing teams" with these athletes. Additional details and the end result of these simulations are included in the results section.

## Results

### Men's Artistic Gymnastics Event

Of the 3000 simulations for both men and women, the 10 simulation with the highest weighted medal score for the United States were separated and re-simulated. For each of these 10 teams, the percentage of simulations where the United States had the highest weighted medal count is included in Table 1 below. The team where the USA won the highest weighted medal count for the largest percentage of the 300 simulations was taken to be the Men's Team USA.

```{=latex}

\newcommand{\highlight}[1]{\colorbox{yellow}{#1}}

```

```{r, echo = FALSE, results='asis'}
  
cat("\\begin{table}[htbp]\n")
cat("\\centering\n")
cat("\\caption{Men's Artistic Gymnastics - Simulations for Possible Top Teams}\n")
cat("\\medskip\n")
cat("\\begin{tabular}{c|c|c|c|c}\n")
cat("\\hline\n")
cat("\\multicolumn{5}{c}{Teams 1-5} \\\\\n")
cat("\\hline\n")
cat("\\textbf{Team 1} & \\textbf{Team 2} & \\textbf{Team 3} & \\textbf{Team 4} & \\textbf{Team 5} \\\\\n")
cat("\\hline\n")
cat("\\multicolumn{5}{c}{Athletes} \\\\\n")
cat("\\hline\n")
cat("Vitaliy Guimaraes & Asher Hong & Riley Loos & Vitaliy Guimaraes & Asher Hong \\\\\n")
cat("Asher Hong & Michael Jaroh & Yul Moldauer & Asher Hong & Jose Lopez \\\\\n")
cat("Brody Malone & Paul Juda & Frederick Richard & Paul Juda & Brody Malone \\\\\n")
cat("Yul Moldauer & Donnell Whittenburg & Shane Wiskus & Ian Lasic & Yul Moldauer \\\\\n")
cat("Donnell Whittenburg & Khoi Young & Khoi Young & Khoi Young & Khoi Young \\\\\n")
cat("\\hline\n")
cat("\\multicolumn{5}{c}{Percentage of Simulations With USA Having Highest Weighted Medal Count} \\\\\n")
cat("\\hline\n")
cat("\\textit{13.7\\%} & \\textit{10.0\\%} & \\textit{6.7\\%} & \\textit{9.3\\%} & \\textit{15.3\\%} \\\\\n")
cat("\\hline\n")
cat("\\multicolumn{5}{c}{Teams 6-10} \\\\\n")
cat("\\cline{1-5}\n")
cat("\\textbf{Team 6} & \\textbf{Team 7} & \\textbf{Team 8} & \\textbf{Team 9} & \\textbf{Team 10} \\\\\n")
cat("\\hline\n")
cat("\\multicolumn{5}{c}{Athletes} \\\\\n")
cat("\\hline\n")
cat("Cameron Bock & Asher Hong & Taylor Burkhart & Raydel Gamboa & Vitaliy Guimaraes \\\\\n")
cat("Matt Cormier & Patrick Hoopes & Vitaliy Guimaraes & Vitaliy Guimaraes & Asher Hong \\\\\n")
cat("Vitaliy Guimaraes & Paul Juda & Brody Malone & Paul Juda & Paul Juda \\\\\n")
cat("Paul Juda & Brody Malone & Yul Moldauer & Riley Loos & Curran Phillips \\\\\n")
cat("Frederick Richaard & Colt Walker & Khoi Young & Khoi Young & Khoi Young \\\\\n")
cat("\\hline\n")
cat("\\multicolumn{5}{c}{Percentage of Simulations With USA Having the Highest Weighted Medal Count} \\\\\n")
cat("\\hline\n")
cat("\\textit{6.7\\%} & \\highlight{\\textit{15.7\\%}} & \\textit{8.7\\%} & \\textit{3.3\\%} & \\textit{USA: 13.7\\%} \\\\\n")
cat("\\hline\n")
cat("\\end{tabular}\n")
cat("\\end{table}\n")

```

As seen in the table above, Team USA is taken to be Asher Hong, Patrick Hoopes, Paul Juda, Brody Malone, and Colt Walker (Team 7 above). This Team USA won the highest weighted medal count of any country 15.7% of time during the second round simulations.

Since this Team 7 was identified as the men's Team USA, we have included Table 2 below to demonstrate a potential outcome of the Olympics with this team. This table portrays the best performance of Team 7 in the 300 simulations that were run. It is important to understand the limitations of showcasing only the best score; the simulation process inherently included randomness and could, although at a low probability, include an unreasonable high score. The outcomes of each other simulation are included in the raw code accessible in GitHub.

```{r, results='asis'}

cat("\\begin{table}[htbp]\n")
cat("\\centering\n")
cat("\\caption{Men's Artistic Gymnastics - Best Simulated Outcome for Chosen Team USA}\n")
cat("\\medskip\n")
cat("\\small\n")
cat("\\begin{tabular}{l|l|l|l}\n")
cat("\\multicolumn{1}{c}{\\textbf{Event}} & \\multicolumn{1}{c}{\\textbf{Gold}} & \\multicolumn{1}{c}{\\textbf{Silver}} & \\multicolumn{1}{c}{\\textbf{Bronze}} \\\\\n")
cat("\\hline\n")
cat("Team All-Around & China & USA & Italy \\\\\n")
cat("\\hline\n")
cat("Individual All-Around & \\highlight{USA (Brody Malone)} & \\highlight{USA (Asher Hong)} & China (Xingyu Lan) \\\\\n")
cat("\\hline\n")
cat("Vault & Great Britain (Jake Jarman) & Philippines (Carlos Yulo) & Ukraine (Nazar Chepurnyi) \\\\\n")
cat("\\hline\n")
cat("Still Rings & \\highlight{USA (Asher Hong)} & Greece (Eleftherios Petrounias) & China (Xingyu Lan) \\\\\n")
cat("\\hline\n")
cat("Pommel Horse & \\highlight{USA (Patrick Hoopes)} & Kazakhstan (Nariman Kurbanov) & Canada (Zachary Clay) \\\\\n")
cat("\\hline\n")
cat("Parallel Bars & Philippines (Carlos Yulo) & Germany (Lukas Dauser) & Japan (Shinnosuke Oka) \\\\\n")
cat("\\hline\n")
cat("High Bar & China (Hao Tian) & Cyprus (Marios Georgiou) & Japan (Shinnosuke Oka) \\\\\n")
cat("\\hline\n")
cat("Floor Exercise & \\highlight{USA (Brody Malone)} & Cuba (Alejandro De) & Philippines (Carlos Yulo) \\\\\n")
cat("\\\\ % Add a blank line to separate the last row\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Athletes: Brody Malone, Asher Hong, Patrick Hoopes, Paul Juda, Colt Walker}} \\\\\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Medal Count:} 6} \\\\\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Weighted Medal Count:} 16 (where Gold = 3, Silver = 2, Bronze = 1)} \\\\\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Medal Breakdown:} 4 Gold, 2 Silver, 0 Bronze}\n")
cat("\\end{tabular}\n")
cat("\\label{tab:gymnastics_medals}\n")
cat("\\end{table}\n")

```

### Women's Artistic Gymnastics Event

The same process above was repeated for the women's event. The results are included in Table 3 below, with the names of the athletes and the percentage of simulations where the United States had the highest weighted medal count.

```{=latex}

\begin{table}[htbp]
\begin{center}
  \caption{Women's Artistic Gymnastics - Simulations for Possible Top Teams}
  \medskip
\begin{tabular}{c|c|c|c|c}
\hline
\multicolumn{5}{c}{Teams 1-5} \\
  \hline
  \textbf{Team 1} & \textbf{Team 2} & \textbf{Team 3} & \textbf{Team 4} & \textbf{Team 5} \\
  \hline
  \multicolumn{5}{c}{Athletes} \\
  \hline
  Simone Biles & Simone Biles & Simone Biles & Simone Biles & Simone Biles \\
  Charlotte Booth & Jade Carey & Jade Carey & Jade Carey & Jade Carey \\
  eMjae Frazier & eMjae Frazier & Karis German & Kayla DiCello & Jordan Chiles \\
  Shilese Jones & Kaliya Lincoln & Shilese Jones & eMjae Frazier & Levi Jung \\
  Leanne Wong & Zoe Miller & Konnor McClain & Konnor McClain & Konnor McClain \\
  \hline
  \multicolumn{5}{c}{Percentage of Simulations With USA Having the Highest Weighted Medal Count} \\
  \hline
  \textit{98.7\%} & \textit{99.0\%} & \textit{99.0\%} & \textit{99.3\%} & \highlight{\textit{99.7\%}} \\
  \hline
  \multicolumn{5}{c}{Teams 6-10} \\
  \cline{1-5}
  \textbf{Team 6} & \textbf{Team 7} & \textbf{Team 8} & \textbf{Team 9} & \textbf{Team 10} \\
  \hline
  \multicolumn{5}{c}{Athletes} \\
  \hline
  Simone Biles & Simone Biles & Simone Biles & Simone Biles & Simone Biles \\
  eMjae Frazier & Jordan Chiles & Addison Fatta & Jordan Chiles & Charlotte Booth \\
  Shilese Jones & eMjae Frazier & Nola Matthews & Silese Jones & Jade Carey \\
  Konnor McClain & Karis German & Konnor McClain & Katelyn Jong & Addison Fatta \\
  Elle Mueller & Konnor McClain & Elle Mueller & Marissa Neal & Konnor McClain \\
  \hline
  \multicolumn{5}{c}{Percentage of Simulations With USA Having the Highest Weighted Medal Count} \\
  \hline
  \highlight{\textit{99.7\%}} & \highlight{\textit{99.7\%}} & \textit{98.7\%} & \highlight{\textit{99.7\%}} & \highlight{\textit{99.7\%}} \\
  \hline
\end{tabular}
\end{center}

\label{tab:top_women_medals}
\end{table}
```
As seen above, Team 5, 6, 7, 9, and 10 are all tied for the percentage of times the USA had the highest weighted medal count (of 99.7%). To break the tie, the number of times each individual athlete appeared in one of the five teams with a 99.7% highest weighted medal count percentage was counted. Simone Biles appeared 5 times in a top-performing team, Konnor McClain appeared 4 times, and Jordan Chiles appeared 3 times. These three were chosen for Team USA. eMjae Frazier, Jade Carey, and Shilese Jones were all chosen 2 times (with the rest of the names appearing here only chosen 1 time). Because Team USA can only consist of five athletes, we ran an additional 300 simulations with every combination of Simone, Konnor, and Jordan, and two of the three athletes that appeared 2 times.

In these additional simulations, the USA won the highest weighted medal count the same percentage of times with each team (99.7% of the time). Therefore, after confirming that these combinations of teams had a tied percentage in a second round of "top simulations", we decided to choose the Team USA that had the highest weighted medal count, on average, from these 300 simulations. The average weighted medal count is included in Table 4 below, along with the athletes who achieved these counts:

```{=latex}

\begin{table}[htbp]
\begin{center}
  \caption{Women's Artistic Gymnastics - Simulations for Tied Top Teams}
  \medskip
\begin{tabular}{c|c|c}
  \textbf{Team 1} & \textbf{Team 2} & \textbf{Team 3} \\
  \cline{1-3}
  \multicolumn{3}{c}{Athletes} \\
  \hline
  Simone Biles & Simone Biles & Simone Biles \\
  Konnor McClain & Konnor McClain & Konnor McClain \\
  Jordan Chiles & Jordan Chiles.& Jordan Chiles \\
  eMjae Frazier & eMjae Frazier & Jade Carey \\
  Jade Carey & Shilese Jones & Shilese Jones \\
  \hline
  \multicolumn{3}{c}{Percentage of Simulations With USA} \\
  \multicolumn{3}{c}{Having the Highest Weighted Medal Count} \\
  \hline
  \textit{99.7\%} & \textit{99.7\%} & \textit{99.7\%} \\
  \hline
  \multicolumn{3}{c}{Average Weighted Medal Count} \\
  \hline
  \textit{16.8} & \textit{17.5} & \textit{18.4} \\
\end{tabular}
\end{center}

\label{tab:top_women_medals}
\end{table}
```
Since Simone Biles, Konnor McClain, Jordan Chiles, Jade Carey, and Shilese Jones had the highest average weighted medal count in these last round of simulations, they were chosen as the women's Team USA.

Since this Team 3 was identified as the women's Team USA, we have included Table 5 below to demonstrate the *best* performance of Team 3 in the 300 simulations that were run in the last iteration of simulations. It is again important to note the limitations of showcasing only the best score from this simulation round (as described above).

```{r, echo=FALSE, results='asis'}

cat("\\begin{table}[htbp]\n")
cat("\\begin{center}\n")  # Center the table
cat("\\caption{Women's Artistic Gymnastics - Best Simulated Outcome for Team USA}\n")
cat("\\medskip\n")
cat("\\small\n")
cat("\\begin{tabular}{l|l|l|l}\n")
cat("\\multicolumn{1}{c}{\\textbf{Event}} & \\multicolumn{1}{c}{\\textbf{Gold}} & \\multicolumn{1}{c}{\\textbf{Silver}} & \\multicolumn{1}{c}{\\textbf{Bronze}} \\\\\n")
cat("\\hline\n")
cat("Team All-Around & \\highlight{USA} & Brazil & China \\\\\n")
cat("\\hline\n")
cat("Individual All-Around & \\highlight{USA (Simone Biles)} & \\highlight{USA (Shilese Jones)} & Brazil (Rebeca Andrade) \\\\\n")
cat("\\hline\n")
cat("Balance Beam & \\highlight{USA (Simone Biles)} & \\highlight{USA (Konnor McClain)} & China (Ran Wu) \\\\\n")
cat("\\hline\n")
cat("Vault & \\highlight{USA (Simone Biles)} & Brazil (Rebeca Andrade) & \\highlight{USA (Jade Carey)} \\\\\n")
cat("\\hline\n")
cat("Floor Exercise & \\highlight{USA (Simone Biles)} & \\highlight{USA (Shilese Jones)} & Brazil (Rebeca Andrade) \\\\\n")
cat("\\hline\n")
cat("Uneven Bars & \\highlight{USA (Shilese Jones)} & Trinidad and Tobago (Annalise Newman) & Algeria (Kaylia Nemour) \\\\\n")
cat("\\\\ % Add a blank line to separate the last row\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Athletes: Simone Biles, Jade Carey, Jordan Chiles, Shilese Jones, Konnor McClain}} \\\\\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Medal Count:} 10} \\\\\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Weighted Medal Count:} 25 (where Gold = 3, Silver = 2, Bronze = 1)} \\\\\n")
cat("\\multicolumn{4}{c}{\\textbf{Team USA Medal Breakdown:} 6 Gold, 3 Silver, 1 Bronze}\n")
cat("\\end{tabular}\n")
cat("\\end{center}\n")  # End the centering environment
cat("\\label{tab:gymnastics_medals}\n")
cat("\\end{table}\n")

```
## Discussion

Simone Biles, Shilese Jones, Jordan Chiles, Konnor McClain, and Jade Carey were selected as the women’s Team USA. All five of these athletes are proven to be highly accomplished [4]: Simone Biles is the most decorated gymnast in history, Shilese Jones was part of the gold-winning team at the 2022 World Championships, Jordan Chiles was part of the gold-winning team at the 2022 World Championships, Konnor McClain is the 2022 U.S. National Champion, and Jade Carey represented Team USA in the Tokyo Olympic Games.

Brody Malone, Asher Hong, Patrick Hoopes, Paul Juda, and Colt Walker were selected as the men's Team USA in the simulation where the USA has the highest weighted medal score. All five of these athletes are also proven to be highly accomplished [4]: Brody Malone is the 2021 and 2022 U.S. National All-Around Champion, Asher Hong was part of the bronze-winning team at the 2023 World Championships, Patrick Hoopes was a 2023 NCAA All-American on the pommel horse, Paul Juda was part of the bronze-winning team at the 2023 World Championships, and Colt Walker was part of the gold-winning team at the 2022 Pan-American Championships.

Figure 1 shows the scores for each athlete selected for Team USA on each apparatus through their 2022-2023 competitions. It can be seen which athletes may be "specialists" versus "all-arounders". These graphs also show the scores of each athlete on each apparatus compared to the others on Team USA, which can be helpful for strategy (for example, selecting which athletes will compete on which apparatus in the team event).

Some items of note are that Patrick Hoopes on the Men's team seems to specialize on the Pommel Horse (he also claims Pommel Horse is his favorite event because "it's not scary") [5]. Simone Biles had not scored below a 14 on any competition in the 2022-2023 dataset; her score distribution being on the higher end is consistent with her earning the title of the most decorated gymnast in history.

```{r}
w_team_usa <- filter(df_women_c, 
                     clean_name == "Simone BILES" |
                     clean_name == "Jade CAREY"|
                     clean_name == "Jordan CHILES"|
                     clean_name == "Konnor MCCLAIN"|
                     clean_name == "Shilese JONES")

w_team_usa <- w_team_usa %>% mutate(clean_name = case_when (
  clean_name == 'Simone BILES' ~ 'Simone Biles',
  clean_name == 'Shilese JONES' ~ 'Shilese Jones',
  clean_name == 'Jordan CHILES' ~ 'Jordan Chiles',
  clean_name == 'Konnor MCCLAIN' ~ 'Konnor McClain',
  clean_name == 'Jade CAREY' ~ 'Jade Carey'
))

m_team_usa <- filter(df_men_c,
                     clean_name == "Asher HONG"|
                       clean_name == "Patrick HOOPES"|
                       clean_name == "Paul JUDA"|
                       clean_name == "Brody MALONE"|
                       clean_name == "Colt WALKER")

m_team_usa <- m_team_usa %>% mutate(clean_name = case_when (
  clean_name == 'Asher HONG' ~ 'Asher Hong',
  clean_name == 'Patrick HOOPES' ~ 'Patrick Hoopes',
  clean_name == 'Paul JUDA' ~ 'Paul Juda',
  clean_name == 'Brody MALONE' ~ 'Brody Malone',
  clean_name == 'Colt WALKER' ~ 'Colt Walker'
))
```

```{r range-of-score-w, fig.cap = "Competition Scores for Each Female Team USA Athlete by Apparatus", fig.margin = TRUE, fig.width = 5, fig.height = 6, hold_position = TRUE}


w_team_usa_no_zero <- filter(w_team_usa, Rank != 0)
range_of_rank_w <- ggplot(data = w_team_usa_no_zero, aes(y= Apparatus, x = Score))+
  geom_point( alpha = .5, color = "#3b4992ff")+
  theme_light()+
  scale_color_aaas()+
  theme(
    plot.title = element_text(size = 10),
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9)
  )+
    labs(
    x = "Score",
    y = "Apparatus",
    title = "Women's Team USA Competition Scores"
  ) +
  facet_wrap(.~clean_name)
```

```{r range-of-score-m, fig.cap = "Competition Scores for Each Male team USA Athlete by Apparatus", fig.margin = TRUE, fig.height = 6, fig.width = 5, hold_position = TRUE}

m_team_usa_no_zero <- filter(m_team_usa, Rank != 0)
range_of_rank_m <- ggplot(data = m_team_usa_no_zero, aes(y= Apparatus, x = Score))+
  geom_point( alpha = .5, color = "#3b4992ff")+
  theme_light()+
  scale_color_aaas()+
  theme(
    plot.title = element_text(size = 9),    
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9)
  )+
    labs(
    x = "Score",
    y = "Apparatus",
    title = "Men's Team USA Competition Scores"
  ) +
  facet_wrap(.~clean_name)


```

```{r range_of_rank_together, fig.cap = "Every Competition Score for Each team USA Athlete by Apparatus", hold_position = TRUE, fig.show = 'asis', fig.width = 7, fig.height = 4}

grid.arrange(range_of_rank_m, range_of_rank_w, ncol = 2)

```

Additionally, we created heatmaps of the average country performance across the 300 simulations with team USA held constant and with the selected athletes from Results. Figure 2, below, shows that for men's gymnastics, individual athletes who do not belong to a qualifying country tend to dominate events such as Pommel Horse, Floor Exercise, Vault, and Still Rings. However, this could be unrealistic in the Olympics, as individual athletes still have to qualify in order to compete. For our selected USA men's team, Team All-Around and Individual All-Around appear to be USA's strong suit. The heatmap also shows that China and Japan are strong competitors. China and Japan have historically dominated past Olympic men gymnastic events [6]. 

Figure 2 shows that for women's gymnastics, our selected USA team tends to dominate most events, except uneven bars. This agrees with historical performances, as the USA has not won gold in Uneven Bars at the Olympics since 1984 [7]. USA's strong suit is Individual All-Around, which also agrees with USA's historical performances. USA has won gold in women's Individual All-Around at every single Olympics since 2004 [8].

```{r heatmap-women}
long_format_data_women = read_rds("Heatmap_data_women")

long_format_data_women <- long_format_data_women |> mutate( Event_clean = case_when(
  Event == "VT_medal" ~ "VT",
  Event == "UB_medal" ~ "UB",
  Event == "Team_AA_medal" ~ "Team AA",
  Event == "indiv_medal" ~ "Indiv",
  Event == "FX_medal" ~ "FX",
  Event == "BB_medal" ~ "BB"
))

heatmap_women <- ggplot(long_format_data_women, aes(x = Country, y = Event_clean, fill = Medals)) +
  geom_tile() +
   scale_fill_gradient(low = "#3b4992ff", high = "gold") +
  theme_light()+
  theme(
    legend.position = c(0.5, 2),
    legend.key.height= unit(.5, 'cm'),
    legend.key.width= unit(1.5, 'cm'),
    plot.title = element_text(size = 9),
    legend.direction = "horizontal",
    plot.margin = margin(t=4,1,1,1, "lines"),
    axis.title.x = element_text(size = 9),
    axis.title.y = element_text(size = 9)
  )+
  labs(title = "Women's Average Country Performance",
       x = NULL,
       y = "Event") 
```

```{r heatmap-men}
long_format_data_men = read_rds("Heatmap_data_men")
long_format_data_men <- long_format_data_men |> mutate( Event_clean = case_when(
  Event == "FX_medal" ~ "FX",
  Event == "HB_medal" ~ "HB",
  Event == "Team_AA_medal" ~ "Team AA",
  Event == "indiv_medal" ~ "Indiv",
  Event == "PB_medal" ~ "PB",
  Event == "PH_medal" ~ "PH",
  Event == "SR_medal" ~ "SR",
  Event == "VT_medal" ~ "VT"
))

heatmap_men <- ggplot(long_format_data_men, aes(x = Country, y = Event_clean, fill = Medals)) +
  geom_tile() +
   scale_fill_gradient(low = "#3b4992ff", high = "gold") +
  theme_light()+
  theme(legend.position="none",
        plot.title = element_text(size = 9),
        axis.title.x = element_text(size = 9),
        axis.title.y = element_text(size = 9))+
  labs(title = "Men's Average Country Performance",
    y = "Event",
       x = "Country",
       fill = "Medals") 
```

```{r heatmap-output, fig.cap = "Average Weighted Medal Count Performance Across Simulations", fig.show = 'asis', fig.height = 4, fig.width = 6}
combined_plot = grid.arrange(heatmap_women, heatmap_men, nrow = 2)
```

An observation, noted in the results section, is that the selected women's Team USA receives the highest weighted medal number in the Olympic simulations more times than the selected men's Team USA. In addition, the best weighted medal score for the women's team is 25 and for the men's team is 16, despite the men having more medal events. This is consistent with the past performance of the Women's team; they are the 2023 reigning World Champions, and won silver at the last Olympics. The Men's team won bronze in the 2023 World Championships and did not place in the last Olympics; however, the individual athletes selected for Team USA have a strong track record described at the beginning of the discussion, and sports commentators believe they have a strong potential to place in the 2024 Games [9]. 

Although not included in the scope of this analysis, the simulation methods here can also provide ideas for Team USA alternates, who will still need to compete and train for the Olympics in case of an unanticipated emergency. For both the men's and women's alternates, it would be reasonable to select from the pool of athletes who made it into one of the "top 10 performing teams" in the first simulation round, but did not ultimately make the cut during the second round of simulations.

It is interesting to compare the athletes on Team USA who were selected from statistical simulations with general online gossip about who is expected to earn a spot on Team USA. There are rich discussions on online forums, including Reddit, that include people's opinions about who will represent Team USA. For example, there is a recent thread with more than 80 comments discussing the 2024 Women's Team USA [10]. The comment with the highest number of "upvotes", which are a form of endorsement other users give to a post, predicts that "Simone and Shilese are now locks", with "Suni, Jade, Jordan, Leanne, Joscelyn, Skye as the next level". Four of the five athletes in our recommended Team USA for women's gymnastics seem to also be popular "fan favorites" on social media. There is less consolidated information on social media for USA men's gymnastics team predictions. 

There are limitations related to both our methodology chosen and inherent in the process of attempting to statistically simulate a future event. As athletes are human beings and there are more than six months until the start of the Olympic Games, uncertainty exists with the training schedules or unforeseen events with the athletes we chose for Team USA in this report. For example, Konnor McClain, who we included in the Women's Team USA, pulled out of a competition this summer due to her recent hand surgery [11]. Although she is still slated to pursue the Olympic Games, uncertainties like these could affect the outcome of the Games. The variability in human performance also includes the competitions that have happened so far, since the statistical methods here only use data from past competitions in 2022 and 2023. Particularly, if an athlete has been injured during the 2022-2023 season but is still planning on competing in the Olympics, they may not have shown up as a high performer in our dataset because of their limited past scores. An example from the United States is Sunisa Lee; although she was the Tokyo Olympics individual all-around champion and hopes to compete in the Paris Games, she has not competed in several competitions in 2023 due to a kidney issue [12]. She ultimately did not make the top simulated choice for Team USA despite winning gold medals at past Olympic Games.

More generally, since our method included taking the median of the kernel densities of each athlete and apparatus for team selection, the median may not provide a comprehensive summary of the data if there are only a small number of data points for an athlete.

Due to our method of creating a continuous distribution from the observed scores of the athletes, the simulation did not truncate the potential scores that athletes could receive at the maximum possible score for each apparatus. The score distributions for each athlete and apparatus potentially allow for technically impossible scores (such as a simulated score higher than the highest possible real-world score), albeit at a low probability.

Additionally, our simulation did not weight scores based on recency, which does not take into account if athletes experienced a growth trajectory during the 2022-2023 season \-  who may have ranked poorly in the beginning competitions but are beginning to perform better \-  had kernel densities that weighted their poor rankings the same as their more recent high rankings. More qualitative data about each athlete could also be important to include. For example, an athlete's future plans or competition data from past Olympics were not included; it could make sense to include whether a past Olympian is defending his/her title, or whether this is someone's last planned Olympics, as determining factors if two athletes have otherwise similar performance history. It could also be important to have feedback from coaches about the mental and physical readiness of each athlete. Including these additional variables could have added nuance to our selection process.

Our method of simulation included assumptions that defined what a "best performance" by Team USA meant. Particularly, the weighting of medals (with gold = 3, silver = 2, and bronze = 1) assumed an increase in prestige that could differ from other interpretations. If the United States is only interested in the total number of people on the podium, for example, a bronze medal may be weighted the same as a gold medal. Another assumption made was that each event medal was equally prestigious; a "gold" in vault was weighted the same as a "gold" in the floor exercise. Depending on the priorities or strategies of the USA Gymnastics, they may see certain events as more important to win (for example to defend a title), in which case it would be appropriate to apply a different level of weighting for weighted random sampling of teams. For example, if team USA wants to focus on winning gold for uneven bars, the weights could then be biased towards gymnasts who compete in this event. These alternative methods could be useful depending on the specific goals of USA Gymnastics.

We were also constrained by computational power and time limitations related to the number of simulations we were able to run. With more computational power, it would have also been possible to run additional iterations to narrow down which team combinations perform best under more circumstances.

A similar simulation methodology to the one used in this report could be applicable to a broader range of Olympic and non-Olympic sports, for sports officials and coaches as well as for individuals hoping to understand how a sports event will go. Our simulation methodology is applicable to many other sporting events which use a standardized scoring system, such as figure skating, archery, and diving. There is also a financial incentive to better understand these competitions and to be able to make predictions. The sports industry had a global revenue of almost \$487 billion U.S. dollars in 2022, with this number expected to grow to \$623 billion U.S. Dollars by 2027 [13]. There is a large incentive for sports officials to hold exciting competitions, and for coaches to select athletes who can achieve high results for their team. In addition, the most prestigious athletic events garner worldwide attention, with many fans betting monetarily as well as emotionally on the outcome of their teams. While this was not our primary focus, our methodology allows for simulation of end results across contestants. Even though there is an inherent element of randomness to sports events, viewers interested in this market could use this simulation methodology to predict the outcomes of the teams.

In conclusion, this paper predicts the 5 men and 5 women who can make Team USA achieve the highest weighted medal score at the Paris 2024 Artistic Gymnastics Events. We recommend that Team USA for the Men's Event should include Brody Malone, Asher Hong, Patrick Hoopes, Paul Juda, and Colt Walker, and Team USA for the Women's Event should include Simone Biles, Shilese Jones, Jordan Chiles, Konnor McClain, and Jade Carey. These accomplished athletes have proven success in the 2022-2023 Gymnastics season, with a demonstrated potential to bring prestige to the United States in the 2024 Olympic Games.

```{r, results='asis', echo=FALSE}

cat("\\newpage\n")

```

# Citations

[1] Young, Jabari. "Simone Biles' Return Helped Tokyo Olympics Viewership, but the Average Stays at 16.8 Million Viewers." CNBC, CNBC, 5 Aug. 2021, www.cnbc.com/2021/08/04/simone-biles-return-helped-olympics-viewership-average-16point8-million.html.

[2] Published by Statista Research Department, and Dec 9. "Most Popular Sports in the Summer Olympics US 2021." Statista, 9 Dec. 2022, www.statista.com/statistics/1245746/summer-olympics-most-followed-sports-us/.

[3] James Herbert Oct 5. "2024 Paris Olympics: Projecting Team USA's 12-Man Roster with Joel Embiid Joining Lebron James, Stephen Curry." CBSSports.Com, 5 Oct. 2023, www.cbssports.com/nba/news/2024-paris-olympics-projecting-team-usas-12-man-roster-with-joel-embiid-joining-lebron-james-stephen-curry/.

[4] "List of IOC Country Codes." Wikipedia, Wikimedia Foundation, 3 Nov. 2023,

en.wikipedia.org/wiki/List_of_IOC_country_codes.

[5] USA Gymnastics, 14 Aug. 2023, usagym.org/.

[6] "Patrick Hoopes - Men's Gymnastics." Air Force Academy Athletics, goairforcefalcons.com/sports/mens-gymnastics/roster/patrick-hoopes/17785. Accessed 19 Nov. 2023.

[7] "Olympic Games History - Men USA Gymnastics." USA Gymnastics, 28 July 2023, usagym.org/history/olympics-men/.

[8] "Uneven Bars at the Olympics." Wikipedia, Wikimedia Foundation, 14 Oct. 2021,

en.wikipedia.org/wiki/Uneven_bars_at_the_Olympics.

[9] "Individual All-around Artistic Gymnastics at the Olympics." Wikipedia, Wikimedia Foundation, 6 May 2023,

en.wikipedia.org/wiki/Individual_all-around_artistic_gymnastics_at_the_Olympics#:\~:text=

The%20individual%20all%2Daround%20is,competition%20was%20added%20in%201952.

[10] Roenigk, Alyssa. "Takeaways from Gymnastics Worlds: Looking Ahead to the 2024 Olympics." ESPN, ESPN Internet Ventures, www.espn.com/olympics/gymnastics/story//id/38603995/2023-gymnastics-worlds-results-2024-olympics-predictions. Accessed 19 Nov. 2023.

[11] "Who Will Be on the USA Women's Team at the 2024 Olympics?" Reddit,

www.reddit.com/r/Gymnastics/comments/1700rmc/who_will_be_on_the_usa_womens_team_at_the_2024/. Accessed 19 Nov. 2023.

[12] Zaccardi, Nick. "Konnor Mcclain to Miss U.S. Gymnastics Meets after Hand Surgery." NBC Sports, NBC Sports, 13 July 2023, www.nbcsports.com/olympics/news/konnor-mcclain-gymnastics-surgery.

[13] Pathak, Manasi. "Olympic Champion Sunisa Lee Expects Paris 2024 Games to Be Stressful." Forbes, Forbes Magazine, 31 July 2023, www.forbes.com/sites/manasipathak-1/2023/07/24/olympic-champion-sunisa-lee-expects-paris-2024-games-to-be-stressful/?sh=53a9ae9c600c.

[14] Gough, Christina. "Global Sports Market Revenue 2027." Statista, 13 July 2023,

www.statista.com/statistics/370560/worldwide-sports-market-revenue/.

[15] "Vault (Gymnastics)." Wikipedia, Wikimedia Foundation, 30 Oct. 2023, en.wikipedia.org/wiki/Vault(gymnastics).

[16] \*\*"Chatgpt." ChatGPT, openai.com/chatgpt. Accessed 19 Nov. 2023.

\*\*Note: We used ChatGPT to help with understanding and using S4 Objects, which we used to store our data, as well as general debugging.

# Appendix

## Figures

```{r winningmost-country-women }

top_countries_women <- filter(df_women_c, 
                              clean_country == "USA"|
                                clean_country == "GBR"|
                                clean_country == "CAN"|
                                clean_country == "CHN"|
                                clean_country == "BRA"|
                                clean_country == "ITA"|
                                clean_country == "NED"|
                                clean_country == "FRA"|
                                clean_country == "JPN"|
                                clean_country == "AUS"|
                                clean_country == "ROU"|
                                clean_country == "KOR")
top_countries_women <- filter(top_countries_women, Rank != 0)

winningmost_country_women <- ggplot(data = top_countries_women, aes(y = clean_country, x = Rank))+
  geom_boxplot( color = "#3b4992ff", alpha = 0.5)+
  theme_light()+
  theme(
    plot.title = element_text(size = 8),
    axis.title.x = element_text(size = 8),
    axis.title.y = element_text(size = 8)
  )+
  labs(
    x = "Women's Competition Ranks by Country",
    y = "Country",
    title = "Appendix 1:Each Athlete's Competition \nRanks for Olympic Qualified Countries "
  )
```

```{r winningmost-country-men}

top_countries_men <- filter(df_men_c, 
                              clean_country == "CHN"|
                                clean_country == "JPN"|
                                clean_country == "GBR"|
                                clean_country == "USA"|
                                clean_country == "CAN"|
                                clean_country == "GER"|
                                clean_country == "ITA"|
                                clean_country == "SUI"|
                                clean_country == "ESP"|
                                clean_country == "TUR"|
                                clean_country == "NED"|
                                clean_country == "UKR")

top_countries_men <- filter(top_countries_men, Rank != 0)
winningmost_country_men <- ggplot(data = top_countries_men, aes(y = clean_country, x = Rank))+
  geom_boxplot(color = "#3b4992ff", alpha = 0.5)+
  theme_light()+
  theme(
    plot.title = element_text(size = 8),
    axis.title.x = element_text(size = 8)
  )+
  labs(
    x = "Men's Competition Ranks by Country",
    y = NULL,
    title = NULL
  ) 
```

```{r adding-winningmost-countries-graphs, fig.height = 4}
grid.arrange(winningmost_country_women, winningmost_country_men, ncol = 2)
```


```{r penalty-dist-women1, fig.cap="Distribution of Penalties by competition scope for Women"}

# for women
#quantile(as.numeric(df_women_c$Penalty), 0.95, na.rm = TRUE)
#quantile(as.numeric(df_women_c$Penalty), 0.51, na.rm = TRUE)

penalty_w <- ggplot(data = df_women_c, aes(x = Penalty)) +
  geom_histogram(bins = 30, color = "#3b4992ff")+
  labs(title = "Appendix 2: Penalty Distribution \nby Competition Scope",
       x = "Penalty for Female Athletes",
       y = "Count") +
  theme_light() +
  scale_color_aaas()

```

```{r penalty-dist-men1, fig.cap="-Appendix: Distribution of Penalties by competition scope for Men"}

# for men
#quantile(as.numeric(df_men_c$Penalty), 0.95, na.rm = TRUE)
#quantile(as.numeric(df_men_c$Penalty), 0.51, na.rm = TRUE)

penalty_m <- ggplot(data = df_men_c, aes(x = Penalty)) +
  geom_histogram(bins = 30, color = "#3b4992ff")+
    labs(title = NULL,
       x = "Penalty for Male Athletes",
       y = NULL) +
  theme_light() +
  scale_color_aaas()

```

```{r output-penalties}
grid.arrange(penalty_w, penalty_m, ncol = 2)
```


## Mathematical Details

### Creating Score Distributions

This Appendix section includes details about how the KDEs for a continuous representation of the score distribution for each athlete and apparatus were created. 

KDE stands for Kernel Density Estimation, it is a nonparametric method to estimate the distribution of a certain set of points. In our case, we used the KDE to estimate the pdf of the score distribution for an athlete's performance on one apparatus. Delving into the mathematical details, the kernel function is evaluated for each past score separately, and these partial results are summed in order to form our KDE.

 We start with a Gaussian kernel with zero mean and unit variance.

$K(x) = \frac{1}{\sqrt{2\pi}}e^{(-\frac{x^2}{2})}$

To shift the kernel to our data point \$x_i\$, we subtract the argument. And to make the kernel wider or narrower, we use a constant in the denominator, h, a kernel bandwidth. We also normalize pdf back to unit area by dividing by h. In general, a smaller h will mean a more narrow kernel pdf. 

The kernel function for each score is therefore the following:

$\frac{1}{h}K \left( \frac{x-x_i}{h} \right)$

To get the overall KDE estimate $f(x)$ for a set of n points, $x_1 \ldots x_n$, we add all the kernel functions together and multiply by $\frac{1}{n}$:

$f(x) = \frac{1}{n} \left[ \frac{1}{h}K \left( \frac{x-x_1}{h} \right) + \ldots + \frac{1}{h}K \left( \frac{x-x_n}{h} \right)  \right]$

 We used the density function in R to create the KDEs for most athletes. If an athlete only had one score for an event, we were unable to generate a realistic KDE estimate, so for these cases, we used a normal distribution with the mean as the athlete's score and standard deviation of 0.1. As mentioned before, we made gymnasts who compete with two vaults have two score distributions for the event: one distribution for the first vault and one distribution for the second vault.

### Team Selection

To create weights for each athlete, we found the median of the KDE for each apparatus they competed in and took a "skewed average" of the medians. We chose this method rather than taking a simple average of the medians since simply averaging the medians would bias the weights toward the specialists in our dataset. For example, an athlete who was really good in only two events, but had zeroes in the other events would have a high average median score, because we are adding the scores and then dividing by 2 (for the two events). For the skewed average, instead of dividing by the number of events $n$ they competed in, we divided by $n+1$. The equation for weight w of $i_{th}$ athlete is as below. 

$w_i =\frac{ median\_apparatus_1 + \ldots + median\_apparatus_n}{n+1}$

This biased our weights towards gymnasts who compete on more apparatuses. While we recognize that focusing on winning individual events could be a team strategy, we found with some testing that having too many specialists could cause more "unrealistic" simulations. For example, if specialists are sampled more often, this could mean cases where there would not be enough athletes able to compete on each apparatus for the Team All Around event. This is especially a concern for men's gymnastics, as they have more apparatuses. Even without weights being applied, we had instances where teams would only have 2 athletes that "could compete" (non zero past scores) for an apparatus. Taking this into consideration, we apply the above bias towards all-around athletes in our weighting scheme. 

After calculating our pseudo average, we realized the weights were really similar to each other. Therefore to "stretch out" the scale,  to emphasize the differences in skill level, we decided to use final weight as $e^{w_i}$. So, if the weight before was 13, the new weight would be $e^{13}$. This helped in differentiating between the athlete's weights and making sure again that the really top athletes were almost always chosen.
