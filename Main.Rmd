---
title: "Main"
author: "Wendy"
date: "2023-10-30"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
# load in libraries
package_list <- c("tidyverse", "vroom", "stringr", "dplyr")

# load in packages
for (package_name in package_list) {
  if (!requireNamespace(package_name, quietly = TRUE)) {
    install.packages(package_name)
  }
  library(package_name, character.only = TRUE)
}

# load in data
df <- vroom("cleandata/data_2022_2023.csv")


```

```{r}
# Clean up names to make sure there is unique name for each athlete.
# taking the first 'word' of the names to simplify
df <- df%>%
  mutate(first_name_only = word(FirstName, 1)) %>%
  mutate(last_name_only = word(LastName, 1))

# standardizing countries. Ex know Scotland and Wales all compete with England as Great Britain.
df_c <- df %>%
  mutate(
    clean_country = case_when(Country == "SCO" ~ "GBR", 
                              Country == "ENG" ~ "GBR", 
                              Country == "WAL" ~ "GBR",
                              Country == "SIN" ~ "SIG", 
                              Country == "GE1" ~ "GER", 
                              Country == "GE2" ~ "GER", 
                              Country == "NIR" ~ "GBR",
                              Country == "IOM" ~ "GBR", 
                              Country == "PUR" ~ "USA",
                              TRUE ~ Country
      
    )
  )

# Simplifying accents in names and dashes
replace_letters <- function(name){
  name <- gsub("Ö", "OE", name)
  name <- gsub("Ü", "U", name)
  name <- gsub("Ø", "O", name)
  name <- sub("-.*", "", name)
  name <- gsub("Ä", "AE", name)
  return(name)
}

standardize <- function(name){
  name <- iconv(name, "UTF-8", "ASCII//TRANSLIT")
  return (name)
}

# Applying accent cleaning function to dataframe's name columns.
df_c$first_name_only <- lapply(df_c$first_name_only, replace_letters)
df_c$last_name_only <- lapply(df_c$last_name_only, replace_letters)

df_c$first_name_only <- lapply(df_c$first_name_only, standardize)
df_c$last_name_only <- lapply(df_c$last_name_only, standardize) 


# mutate to create name variable comprising of both first and last name
df_c <- df_c %>%
  mutate(name = paste(first_name_only, last_name_only))

# Separating into two dataset of men and women's gymnastics
df_men_c <- df_c%>%
  filter(Gender == "m")

df_women_c <- df_c%>%
  filter(Gender == "w")

  
```


```{r}
# Manual cleaning done on name for women's data
df_women_c <- df_women_c %>%
  mutate(
    clean_name = case_when(
      name == "Anna KONIG" ~ "Anna KOENIG",
      name == "Aberdeen O" ~ "Aberdeen O'DRISCOL", 
      name == "Christina KIOSO" ~ "Christina VASILOPOULOU",
      name == "Korkem YEROBSSYNKYZY" ~ "Korkem YERBOSSYNKYZY",
      name == "Larasati REGGANIS" ~ "Larasati RENGGANIS", 
      name == "Liu MAI" ~ "Mai LIU" ,
      name == "Melanie DE" ~ "Melanie DE JESUS", 
      name == "Melanie JESUS" ~ "Melanie DE JESUS", 
      name == "Milka ELPITIYA" ~ "Milka GEHANI", 
      name == "NA ELPITIYA" ~ "Milka GEHANI", 
      name == "Nika KUKULJAN" ~ "Nika FRLETA", 
      name == "Olivia MAFES" ~ "Olivia Kelly", 
      name == "Ruby EVAN" ~ "Ruby EVANS", 
      name == "Sasiwimion MUEANGPHUAN" ~ "Sasiwimon MUEANGPHUAN", 
      name == "Shade OORSCHOT" ~ "Shade VAN OORSCHOT",
      name == "Shade VAN" ~ "Shade VAN OORSCHOT", 
      name == "Vera VAN" ~ "Vera VAN POL", 
      name == "Vera POL"  ~ "Vera VAN POL", 
      name == "Wong VANESSA" ~ "Vanessa WONG", 
      name == "Zeina SHARAF" ~ "Zeina IBRAHIM", 
      name == "NA JESUS" ~ "Melanie DE JESUS",
      TRUE ~ name
    )
  )

# Manual cleaning done on country specifications for women's data
df_women_c <- df_women_c %>%
  mutate(
    clean_country = ifelse(clean_name == "Teja BELAK", "SLO", clean_country), 
    clean_country = ifelse(clean_name == "Naveen DARIES", "RSA", clean_country), 
    clean_country = ifelse(clean_name == "Madeleine MARSHALL", "NZL", clean_country)
  )
```






```{r}
# Manual cleaning done on name for men's data
df_men_c <- df_men_c %>%
  mutate(
    clean_name = case_when(
      name == "Mc ATEER" ~ "Ewan MCATEER",
      name == "Ewan MC" ~ "Ewan MCATEER", 
      name == "Mc CLENAGHAN" ~ "Rhys MCCLENAGHAN",
      name == "Rhys MC" ~ "Rhys MCCLENAGHAN",
      name == "Samual DICK" ~ "Samuel DICK",
      name == "William FU" ~ "William FUALLEN",
      name == "Jermain GRUNBERG" ~ "Jermain GRUENBERG", 
      name == "Rakah HARITHI" ~ "Rakan HARITHI",
      name == "Vinzenz HOCK" ~ "Vinzenz HOECK",
      name == "VInzenz HOECK" ~ "Vinzenz HOECK",
      name == "Mohamad KHALIL" ~ "Mohamed KHALIL",
      name == "Severin KRANZLMULLER" ~ "Severin KRANZLMUELLER",
      name == "NA KUMARASINGHEGE" ~ "Hansha KUMARASINGHEGE",
      name == "Manuel MARTINEZ" ~ "Jose MARTINEZ",
      name == "Felipe MARTINEZ" ~ "Andres MARTINEZ",
      name == "Clay MASON" ~ "Clay MASONSTEPHENS",
      name == "Dimitrijs MICKEVICS" ~ "Dmitrijs MICKEVICS",
      name == "Dmitry PATANIN" ~ "Dmitriy PATANIN",
      name == "NA SOUZA" ~ "Caio SOUZA",
      name == "Jann TIMBANG" ~ "Jan TIMBANG",
      name == "Kim VANSTROM" ~ "Kim VANSTROEM",
      name == "Sam ZAKUTNEY" ~ "Samuel ZAKUTNEY",
      TRUE ~ name
    )
  )

# Manual cleaning done on country specifications for men's data
df_men_c <- df_men_c %>%
  mutate(
    clean_country = ifelse(clean_name == "Ewan MCATEER", "IRL", clean_country), 
    clean_country = ifelse(clean_name == "Rhys MCCLENAGHAN", "IRL", clean_country), 
    clean_country = ifelse(clean_name == "Dominick CUNNINGHAM", "IRL", clean_country),
    clean_country = ifelse(clean_name == "Eamon MONTGOMERY", "IRL", clean_country),
    clean_country = ifelse(clean_name == "NIkita SIMONOV", "AZE", clean_country)
  )

```


```{r}
df_men_names <- df_men_c %>%
  distinct(last_name_only, first_name_only, clean_country, name)

```

```{r ordering-competitions-women}

unique(df_women_c$Competition)

df_women_c <- df_women_c %>%
  mutate(competition_number = case_when(
    Competition == "2022 Cottbus World Cup" ~ "1",
    Competition == "2022 Winter Cup" ~ "2",
    Competition == "2022 Doha World Cup" ~ "3",
    Competition == "2022 Cairo World Cup" ~ "4",
    Competition == "2022 British Gymnastics Championships" ~ "5",
    Competition == "2022 Varna World Challenge Cup" ~ "6",
    Competition == "2022 Baku World Cup" ~ "7",
    Competition == "2022 Osijek World Challenge Cup" ~ "8",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "9",
    Competition == "2022 Koper World Challenge Cup" ~ "10",
    Competition == "2022 U.S. Classic" ~ "11",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "12",
    Competition == "2022 Senior European Championships" ~ "13",
    Competition == "2022 U.S. Championships" ~ "14",
    Competition == "2022 Paris World Challenge Cup" ~ "15",
    Competition == "2022 Szombathely World Challenge Cup" ~ "16",
    Competition == "2022 Mersin World Challenge Cup" ~ "17",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "18",
    Competition == "2023 Cottbus World Cup" ~ "19",
    Competition == "2023 Winter Cup" ~ "20",
    Competition == "2023 Doha World Cup" ~ "21",
    Competition == "2023 Baku World Cup" ~ "22",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "23",
    Competition == "2023 British Gymnastics Championships" ~ "24",
    Competition == "2023 Senior European Championships" ~ "25",
    Competition == "2023 Cairo World Cup" ~ "26",
    Competition == "2023 Varna World Challenge Cup" ~ "27",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "28",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "29",
    Competition == "2023 Osijek World Challenge Cup" ~ "30",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "31",
    Competition == "2023 Central American and Caribbean Games" ~ "32",
    Competition == "2023 FISU World University Games" ~ "33",
    Competition == "2023 Core Hydration Classic" ~ "34",
    Competition == "2023 U.S. Championships" ~ "35",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "36",
    TRUE ~ "Other"
  ))

df_women_c = df_women_c %>%
  mutate(competition_number = as.numeric(competition_number))

```

```{r categorizing-competitions-women}

df_women_c <- df_women_c %>%
  mutate(competition_scope = case_when(
    Competition == "2022 Cottbus World Cup" ~ "World",
    Competition == "2022 Winter Cup" ~ "USA",
    Competition == "2022 Doha World Cup" ~ "World",
    Competition == "2022 Cairo World Cup" ~ "World",
    Competition == "2022 British Gymnastics Championships" ~ "non-USA",
    Competition == "2022 Varna World Challenge Cup" ~ "World",
    Competition == "2022 Baku World Cup" ~ "World",
    Competition == "2022 Osijek World Challenge Cup" ~ "World",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2022 Koper World Challenge Cup" ~ "World",
    Competition == "2022 U.S. Classic" ~ "USA",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "non-USA",
    Competition == "2022 Senior European Championships" ~ "non-USA",
    Competition == "2022 U.S. Championships" ~ "USA",
    Competition == "2022 Paris World Challenge Cup" ~ "World",
    Competition == "2022 Szombathely World Challenge Cup" ~ "World",
    Competition == "2022 Mersin World Challenge Cup" ~ "World",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "World",
    Competition == "2023 Cottbus World Cup" ~ "World",
    Competition == "2023 Winter Cup" ~ "USA",
    Competition == "2023 Doha World Cup" ~ "World",
    Competition == "2023 Baku World Cup" ~ "World",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "World",
    Competition == "2023 British Gymnastics Championships" ~ "non-USA",
    Competition == "2023 Senior European Championships" ~ "non-USA",
    Competition == "2023 Cairo World Cup" ~ "World",
    Competition == "2023 Varna World Challenge Cup" ~ "World",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "USA",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "World",
    Competition == "2023 Osijek World Challenge Cup" ~ "World",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2023 Central American and Caribbean Games" ~ "non-USA",
    Competition == "2023 FISU World University Games" ~ "USA",
    Competition == "2023 Core Hydration Classic" ~ "USA",
    Competition == "2023 U.S. Championships" ~ "USA",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "World",
    TRUE ~ "Other"
  ))

```

```{r ordering-competitions-men}

unique(df_men$Competition)

df_men_c <- df_men_c %>%
  mutate(competition_number = case_when(
    Competition == "2022 Cottbus World Cup" ~ "1",
    Competition == "2022 Winter Cup" ~ "2",
    Competition == "2022 Doha World Cup" ~ "3",
    Competition == "2022 Cairo World Cup" ~ "4",
    Competition == "2022 British Gymnastics Championships" ~ "5",
    Competition == "2022 Varna World Challenge Cup" ~ "6",
    Competition == "2022 Baku World Cup" ~ "7",
    Competition == "2022 Osijek World Challenge Cup" ~ "8",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "9",
    Competition == "2022 Koper World Challenge Cup" ~ "10",
    Competition == "2022 U.S. Classic" ~ "11",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "12",
    Competition == "2022 Senior European Championships" ~ "13",
    Competition == "2022 U.S. Championships" ~ "14",
    Competition == "2022 Paris World Challenge Cup" ~ "15",
    Competition == "2022 Szombathely World Challenge Cup" ~ "16",
    Competition == "2022 Mersin World Challenge Cup" ~ "17",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "18",
    Competition == "2023 Cottbus World Cup" ~ "19",
    Competition == "2023 Winter Cup" ~ "20",
    Competition == "2023 Doha World Cup" ~ "21",
    Competition == "2023 Baku World Cup" ~ "22",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "23",
    Competition == "2023 British Gymnastics Championships" ~ "24",
    Competition == "2023 Senior European Championships" ~ "25",
    Competition == "2023 Cairo World Cup" ~ "26",
    Competition == "Oceania Continental Championships 2023" ~ "27",
    Competition == "2023 Varna World Challenge Cup" ~ "28",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "29",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "30",
    Competition == "2023 Osijek World Challenge Cup" ~ "31",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "32",
    Competition == "2023 Central American and Caribbean Games" ~ "33",
    Competition == "2023 FISU World University Games" ~ "34",
    Competition == "2023 Core Hydration Classic" ~ "35",
    Competition == "2023 U.S. Championships" ~ "36",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "37",
    TRUE ~ "Other"
  ))

df_men_c = df_men_c %>%
  mutate(competition_number = as.numeric(competition_number))

```

```{r categorizing-competitions-men}

df_men_c <- df_men_c %>%
  mutate(competition_scope = case_when(
    Competition == "2022 Cottbus World Cup" ~ "World",
    Competition == "2022 Winter Cup" ~ "USA",
    Competition == "2022 Doha World Cup" ~ "World",
    Competition == "2022 Cairo World Cup" ~ "World",
    Competition == "2022 British Gymnastics Championships" ~ "non-USA",
    Competition == "2022 Varna World Challenge Cup" ~ "World",
    Competition == "2022 Baku World Cup" ~ "World",
    Competition == "2022 Osijek World Challenge Cup" ~ "World",
    Competition == "2022 9th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2022 Koper World Challenge Cup" ~ "World",
    Competition == "2022 U.S. Classic" ~ "USA",
    Competition == "BIRMINGHAM 2022 Commonwealth Games" ~ "non-USA",
    Competition == "2022 Senior European Championships" ~ "non-USA",
    Competition == "2022 U.S. Championships" ~ "USA",
    Competition == "2022 Paris World Challenge Cup" ~ "World",
    Competition == "2022 Szombathely World Challenge Cup" ~ "World",
    Competition == "2022 Mersin World Challenge Cup" ~ "World",
    Competition == "2022 51st FIG Artistic Gymnastics World Championships" ~ "World",
    Competition == "2023 Cottbus World Cup" ~ "World",
    Competition == "2023 Winter Cup" ~ "USA",
    Competition == "2023 Doha World Cup" ~ "World",
    Competition == "2023 Baku World Cup" ~ "World",
    Competition == "EnBW DTB Pokal Team Challenge 2023" ~ "World",
    Competition == "2023 British Gymnastics Championships" ~ "non-USA",
    Competition == "2023 Senior European Championships" ~ "non-USA",
    Competition == "2023 Cairo World Cup" ~ "World",
    Competition == "Oceania Continental Championships 2023" ~ "non-USA",
    Competition == "2023 Varna World Challenge Cup" ~ "World",
    Competition == "2023 Artistic Gymnastics Senior Pan American Championships" ~ "USA",
    Competition == "2023 Tel Aviv World Challenge Cup" ~ "World",
    Competition == "2023 Osijek World Challenge Cup" ~ "World",
    Competition == "2023 10th Senior Artistic Gymnastics Asian Championships" ~ "non-USA",
    Competition == "2023 Central American and Caribbean Games" ~ "non-USA",
    Competition == "2023 FISU World University Games" ~ "USA",
    Competition == "2023 Core Hydration Classic" ~ "USA",
    Competition == "2023 U.S. Championships" ~ "USA",
    Competition == "2023 52nd FIG Artistic Gymnastics World Championships" ~ "World",
    TRUE ~ "Other"
  ))

```


